{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projects_User\\\\lucky\\\\full_project\\\\frontend\\\\src\\\\components\\\\page\\\\Admin\\\\QuanLyVaiTro\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { BrowserRouter as Router, Switch, Route, Link, Redirect, useHistory } from \"react-router-dom\";\nimport api from '../../role_api';\nimport ThemVaiTro from './ThemVaiTro';\nimport ChinhSuaVaiTro from './ChinhSuaVaiTro';\nimport DanhSachVaiTro from './DanhSachVaiTro';\nimport NavBar from './NavBar';\nimport Header from '../../../basic_components/Header';\nimport Footer from '../../../basic_components/Footer';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction VaiTro() {\n  _s();\n\n  const isMountedVal = React.useRef(1);\n  const history = useHistory();\n  const [roles, setRoles] = React.useState([]);\n\n  const get_roles = async () => {\n    const result = await api.get('/get-roles');\n\n    if (result.data.status === true) {\n      setRoles([...result.data.roles]);\n    }\n  };\n\n  const updateState = callback => {\n    if (isMountedVal.current === 1) {\n      callback();\n    }\n  };\n\n  const create = async role => {\n    const result = await api.post('/add-role', role);\n\n    if (result.data.status === true) {\n      const new_role = result.data.role;\n      setRoles([...roles, {\n        role_id: new_role.role_id,\n        role_name: new_role.role_name,\n        active: new_role.active\n      }]);\n      alert(\"Thêm vai trò thành công.\");\n    } else {\n      alert(result.data.message);\n      history.push('/admin/roles');\n    }\n  };\n\n  const remove = async id => {\n    const result = await api.delete(`/delete-role/${id}`);\n\n    if (result.data.status === true) {\n      setRoles(roles.filter(role => role.role_id !== id));\n    } else {\n      alert(result.data.message);\n    } // axios delete\n    // const new_data = users_roles.filter(item => item.id !== id);;\n    // setUsersRoles(new_data);\n\n  };\n\n  const update = async item => {\n    const {\n      role_id\n    } = item;\n    const result = await api.put(`/update-role/${role_id}`, item);\n\n    if (result.data.status === true) {\n      const edited_role = result.data.role;\n      setRoles(roles.map(role => role.role_id !== role_id ? role : edited_role));\n    } else {\n      alert(result.data.message);\n    } // const response = {}; //lấy dữ liệu trả về sau khi edit\n    // const { mauser } = response.data;;\n    // const new_data = users_roles.map((item) => {\n    //     return item.mauser !== mauser ? item : { ...response.data }\n    // })\n    // setUsersRoles(new_data);\n\n  };\n\n  React.useEffect(() => {\n    updateState(get_roles);\n    isMountedVal.current = 0;\n    return () => {\n      isMountedVal.current = 0;\n    };\n  }, [isMountedVal]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Router, {\n      children: [/*#__PURE__*/_jsxDEV(NavBar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/admin/roles\",\n          render: props => /*#__PURE__*/_jsxDEV(DanhSachVaiTro, { ...props,\n            roles: roles,\n            remove: remove\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 67\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/admin/add-roles\",\n          render: props => /*#__PURE__*/_jsxDEV(ThemVaiTro, { ...props,\n            handleCreate: create\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/admin/edit-roles\",\n          render: props => /*#__PURE__*/_jsxDEV(ChinhSuaVaiTro, { ...props,\n            handleUpdate: update\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 9\n  }, this);\n}\n\n_s(VaiTro, \"CxXJZ1TdKGsbh0zCBZYxFKmI8Q8=\", false, function () {\n  return [useHistory];\n});\n\n_c = VaiTro;\nexport default VaiTro;\n\nvar _c;\n\n$RefreshReg$(_c, \"VaiTro\");","map":{"version":3,"sources":["C:/Projects_User/lucky/full_project/frontend/src/components/page/Admin/QuanLyVaiTro/index.js"],"names":["React","BrowserRouter","Router","Switch","Route","Link","Redirect","useHistory","api","ThemVaiTro","ChinhSuaVaiTro","DanhSachVaiTro","NavBar","Header","Footer","VaiTro","isMountedVal","useRef","history","roles","setRoles","useState","get_roles","result","get","data","status","updateState","callback","current","create","role","post","new_role","role_id","role_name","active","alert","message","push","remove","id","delete","filter","update","item","put","edited_role","map","useEffect","props"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { BrowserRouter as Router, Switch, Route, Link, Redirect, useHistory } from \"react-router-dom\";\r\nimport api from '../../role_api';\r\nimport ThemVaiTro from './ThemVaiTro';\r\nimport ChinhSuaVaiTro from './ChinhSuaVaiTro';\r\nimport DanhSachVaiTro from './DanhSachVaiTro';\r\nimport NavBar from './NavBar';\r\nimport Header from '../../../basic_components/Header';\r\nimport Footer from '../../../basic_components/Footer';\r\n\r\nfunction VaiTro() {\r\n    const isMountedVal = React.useRef(1);\r\n    const history = useHistory();\r\n\r\n    const [roles, setRoles] = React.useState([]);\r\n\r\n    const get_roles = async () => {\r\n        const result = await api.get('/get-roles');\r\n        if (result.data.status === true) {\r\n            setRoles([...result.data.roles]);\r\n        }\r\n    }\r\n\r\n    const updateState = (callback) => {\r\n        if (isMountedVal.current === 1) {\r\n            callback();\r\n        }\r\n    }\r\n\r\n    const create = async (role) => {\r\n        const result = await api.post('/add-role', role);\r\n        if (result.data.status === true) {\r\n            const new_role = result.data.role;\r\n            setRoles([...roles, {\r\n                role_id: new_role.role_id,\r\n                role_name: new_role.role_name,\r\n                active: new_role.active,\r\n            }]);\r\n            alert(\"Thêm vai trò thành công.\")\r\n        }\r\n        else {\r\n            alert(result.data.message);\r\n            history.push('/admin/roles')\r\n        }\r\n    }\r\n\r\n    const remove = async (id) => {\r\n        const result = await api.delete(`/delete-role/${id}`);\r\n        if (result.data.status === true) {\r\n            setRoles(\r\n                roles.filter(role => role.role_id !== id)\r\n            )\r\n        }\r\n        else {\r\n            alert(result.data.message);\r\n        }\r\n        // axios delete\r\n\r\n        // const new_data = users_roles.filter(item => item.id !== id);;\r\n        // setUsersRoles(new_data);\r\n    }\r\n\r\n    const update = async (item) => {\r\n        const { role_id } = item;\r\n        const result = await api.put(`/update-role/${role_id}`, item);\r\n        if (result.data.status === true) {\r\n            const edited_role = result.data.role;\r\n            setRoles(\r\n                roles.map(role => role.role_id !== role_id ? role : edited_role)\r\n            )\r\n        }\r\n        else {\r\n            alert(result.data.message);\r\n        }\r\n        // const response = {}; //lấy dữ liệu trả về sau khi edit\r\n        // const { mauser } = response.data;;\r\n        // const new_data = users_roles.map((item) => {\r\n        //     return item.mauser !== mauser ? item : { ...response.data }\r\n        // })\r\n        // setUsersRoles(new_data);\r\n\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        updateState(get_roles);\r\n\r\n        isMountedVal.current = 0;\r\n\r\n        return () => {\r\n            isMountedVal.current = 0;\r\n        }\r\n    }, [isMountedVal])\r\n\r\n    return (\r\n        <div>\r\n            <Router>\r\n                <NavBar />\r\n                <Switch>\r\n\r\n                    <Route path=\"/admin/roles\" render={(props) => <DanhSachVaiTro {...props} roles={roles} remove={remove} />} />\r\n\r\n                    <Route exact path=\"/admin/add-roles\" render={(props) => (\r\n                        <ThemVaiTro {...props} handleCreate={create} />\r\n                    )} />\r\n\r\n                    <Route\r\n                        path=\"/admin/edit-roles\"\r\n                        render={(props) => (\r\n                            <ChinhSuaVaiTro\r\n                                {...props}\r\n                                handleUpdate={update}\r\n                            />\r\n                        )}\r\n                    />\r\n\r\n                </Switch>\r\n            </Router>\r\n            {/* </div>\r\n            </div>\r\n            </div>\r\n            <Footer /> */}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default VaiTro\r\n"]},"metadata":{},"sourceType":"module"}