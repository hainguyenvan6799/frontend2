{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projects_User\\\\lucky\\\\full_project\\\\frontend\\\\src\\\\components\\\\page\\\\User\\\\TaiLieuNew\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport axios from \"axios\";\nimport React from \"react\";\nimport { mahoadulieu_postform } from \"../../security\";\nimport ClipLoader from \"react-spinners/ClipLoader\";\nimport DanhSachTaiLieu from \"./DanhSachTaiLieu\";\nimport { BrowserRouter as Router, Switch, Route, Link } from \"react-router-dom\";\nimport ThemTaiLieu from \"./ThemTaiLieu\";\nimport ChinhSuaTaiLieu from \"./ChinhSuaTaiLieu\";\nimport { channel } from \"../../../../Store\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction TaiLieu(props) {\n  _s();\n\n  const [isLoading, setIsLoading] = React.useState(true);\n  var isMounted = true;\n  const [tailieu, setTaiLieu] = React.useState([]);\n  const [tailieuPending, setTaiLieuPending] = React.useState([]);\n\n  const get_username_of_user = (arr, checkMauser) => {\n    const user = arr.find(({\n      mauser\n    }) => mauser === checkMauser);\n    return user.name;\n  };\n\n  const get_url_of_file = (arr, checkMatailieu) => {\n    const tailieu = arr.find(({\n      matailieu\n    }) => matailieu === checkMatailieu);\n    return tailieu.url;\n  };\n\n  const get_tailieu = async () => {\n    const data = {\n      resource_id: mahoadulieu_postform(`tl_${props.userlogin.malop}`)\n    };\n    const response = await axios.post(\"/api/get-tailieu-of-specific-class\", data);\n\n    if (response.data.status) {\n      const users = response.data.users;\n      const urls = response.data.urls;\n      response.data.data.map(item => {\n        if (isMounted) {\n          item.username = get_username_of_user(users, item.mauser);\n          item.url = get_url_of_file(urls, item.matailieu);\n\n          if (item.active) {\n            setTaiLieu(tailieu => [...tailieu, item]);\n          } else {\n            setTaiLieuPending(tailieuPending => [...tailieuPending, item]);\n          }\n\n          setIsLoading(false);\n        }\n      });\n    }\n  };\n\n  React.useEffect(() => {\n    get_tailieu();\n    return () => {\n      isMounted = false;\n      setIsLoading(false);\n    };\n  }, []);\n\n  const handleDeleteTaiLieu = () => {// channel.bind(\"App\\\\Events\\\\MyEvent\", (data) => {\n    //   console.log(\"pusher\", data);\n    //   if (data.data.isDelete) {\n    //     if (data.data.active) {\n    //       const newData = tailieu.filter((item) => item._id !== data.data._id);\n    //       setTaiLieu(newData);\n    //     } else {\n    //       const newData = tailieuPending.filter(\n    //         (item) => item._id !== data.data._id\n    //       );\n    //       setTaiLieuPending(newData);\n    //     }\n    //   }\n    // });\n  };\n\n  React.useEffect(() => {\n    channel.bind(\"App\\\\Events\\\\MyEvent\", data => {\n      console.log(\"pusher\", data);\n\n      if (data.data.resource_id === `tl_${props.userlogin.malop}`) {\n        if (data.data.isDelete) {\n          if (data.data.active) {\n            //   const newData = tailieu.filter((item) => item._id !== data.data._id);\n            setTaiLieu(tailieu => [...tailieu.filter(item => item._id !== data.data._id)]);\n          } else {\n            setTaiLieuPending(tailieu => [...tailieu.filter(item => item._id !== data.data._id)]);\n          }\n        }\n\n        if (data.data.isAdd === true) {\n          let item = data.data;\n          item._id = item._id[\"$oid\"];\n\n          if (item.active === true) {\n            setTaiLieu(tailieu => [...tailieu, item]);\n          } else {\n            setTaiLieuPending(tailieu => [...tailieu, item]);\n          }\n        }\n\n        if (data.data.isUpdate === true) {\n          if (data.data.active) {\n            setTaiLieu(tailieu => tailieu.map(item => item._id === data.data._id ? data.data : item));\n          } else {\n            setTaiLieu(tailieu => tailieu.filter(item => item._id !== data.data._id));\n            setTaiLieuPending(tailieu => [...tailieu, data.data]);\n          }\n        }\n\n        if (data.data.isApprove === true) {\n          setTaiLieu(tailieu => [...tailieu, data.data]);\n          setTaiLieuPending(tailieu => tailieu.filter(item => item._id !== data.data._id));\n        }\n      }\n    });\n  }, []);\n  return isLoading ? /*#__PURE__*/_jsxDEV(ClipLoader, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 135,\n    columnNumber: 5\n  }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Router, {\n      children: [/*#__PURE__*/_jsxDEV(\"nav\", {\n        className: \"navbar navbar-expand-lg navbar-light bg-light\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"navbar-toggler\",\n          type: \"button\",\n          \"data-toggle\": \"collapse\",\n          \"data-target\": \"#navbarSupportedContent\",\n          \"aria-controls\": \"navbarSupportedContent\",\n          \"aria-expanded\": \"false\",\n          \"aria-label\": \"Toggle navigation\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"navbar-toggler-icon\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"collapse navbar-collapse\",\n          id: \"navbarSupportedContent\",\n          children: /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"navbar-nav mr-auto\",\n            children: /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"nav-item\",\n              children: /*#__PURE__*/_jsxDEV(Link, {\n                className: \"nav-link\",\n                to: {\n                  pathname: `/them-tai-lieu`,\n                  state: {\n                    malop: props.privateInfo.malop,\n                    accessRights: props.accessRights,\n                    userlogin: props.userlogin\n                  }\n                },\n                children: \"Th\\xEAm t\\xE0i li\\u1EC7u\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DanhSachTaiLieu, {\n        tailieu: tailieu,\n        tailieuPending: tailieuPending,\n        accessRights: props.accessRights,\n        userlogin: props.userlogin,\n        handleDeleteTaiLieu: handleDeleteTaiLieu\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-12\",\n        children: /*#__PURE__*/_jsxDEV(Switch, {\n          children: [/*#__PURE__*/_jsxDEV(Route, {\n            exact: true,\n            path: \"/them-tai-lieu\",\n            component: props => /*#__PURE__*/_jsxDEV(ThemTaiLieu, { ...props,\n              // handleCreate={handleCreate}\n              privateInfo: props.privateInfo\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            exact: true,\n            path: \"/chinh-sua-tai-lieu\",\n            component: props => /*#__PURE__*/_jsxDEV(ChinhSuaTaiLieu, { ...props\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n\n_s(TaiLieu, \"0k3bhIIrgJR7r1nFJ5Rzpcr8njw=\");\n\n_c = TaiLieu;\nexport default TaiLieu;\n\nvar _c;\n\n$RefreshReg$(_c, \"TaiLieu\");","map":{"version":3,"sources":["C:/Projects_User/lucky/full_project/frontend/src/components/page/User/TaiLieuNew/index.js"],"names":["axios","React","mahoadulieu_postform","ClipLoader","DanhSachTaiLieu","BrowserRouter","Router","Switch","Route","Link","ThemTaiLieu","ChinhSuaTaiLieu","channel","TaiLieu","props","isLoading","setIsLoading","useState","isMounted","tailieu","setTaiLieu","tailieuPending","setTaiLieuPending","get_username_of_user","arr","checkMauser","user","find","mauser","name","get_url_of_file","checkMatailieu","matailieu","url","get_tailieu","data","resource_id","userlogin","malop","response","post","status","users","urls","map","item","username","active","useEffect","handleDeleteTaiLieu","bind","console","log","isDelete","filter","_id","isAdd","isUpdate","isApprove","pathname","state","privateInfo","accessRights"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport React from \"react\";\r\nimport { mahoadulieu_postform } from \"../../security\";\r\nimport ClipLoader from \"react-spinners/ClipLoader\";\r\nimport DanhSachTaiLieu from \"./DanhSachTaiLieu\";\r\nimport { BrowserRouter as Router, Switch, Route, Link } from \"react-router-dom\";\r\nimport ThemTaiLieu from \"./ThemTaiLieu\";\r\nimport ChinhSuaTaiLieu from \"./ChinhSuaTaiLieu\";\r\n\r\nimport { channel } from \"../../../../Store\";\r\n\r\nfunction TaiLieu(props) {\r\n  const [isLoading, setIsLoading] = React.useState(true);\r\n  var isMounted = true;\r\n\r\n  const [tailieu, setTaiLieu] = React.useState([]);\r\n  const [tailieuPending, setTaiLieuPending] = React.useState([]);\r\n\r\n  const get_username_of_user = (arr, checkMauser) => {\r\n    const user = arr.find(({ mauser }) => mauser === checkMauser);\r\n    return user.name;\r\n  };\r\n\r\n  const get_url_of_file = (arr, checkMatailieu) => {\r\n    const tailieu = arr.find(({ matailieu }) => matailieu === checkMatailieu);\r\n    return tailieu.url;\r\n  };\r\n\r\n  const get_tailieu = async () => {\r\n    const data = {\r\n      resource_id: mahoadulieu_postform(`tl_${props.userlogin.malop}`),\r\n    };\r\n    const response = await axios.post(\r\n      \"/api/get-tailieu-of-specific-class\",\r\n      data\r\n    );\r\n    if (response.data.status) {\r\n      const users = response.data.users;\r\n      const urls = response.data.urls;\r\n      response.data.data.map((item) => {\r\n        if (isMounted) {\r\n          item.username = get_username_of_user(users, item.mauser);\r\n          item.url = get_url_of_file(urls, item.matailieu);\r\n\r\n          if (item.active) {\r\n            setTaiLieu((tailieu) => [...tailieu, item]);\r\n          } else {\r\n            setTaiLieuPending((tailieuPending) => [...tailieuPending, item]);\r\n          }\r\n          setIsLoading(false);\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    get_tailieu();\r\n\r\n    return () => {\r\n      isMounted = false;\r\n      setIsLoading(false);\r\n    };\r\n  }, []);\r\n\r\n  const handleDeleteTaiLieu = () => {\r\n    // channel.bind(\"App\\\\Events\\\\MyEvent\", (data) => {\r\n    //   console.log(\"pusher\", data);\r\n    //   if (data.data.isDelete) {\r\n    //     if (data.data.active) {\r\n    //       const newData = tailieu.filter((item) => item._id !== data.data._id);\r\n    //       setTaiLieu(newData);\r\n    //     } else {\r\n    //       const newData = tailieuPending.filter(\r\n    //         (item) => item._id !== data.data._id\r\n    //       );\r\n    //       setTaiLieuPending(newData);\r\n    //     }\r\n    //   }\r\n    // });\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    channel.bind(\"App\\\\Events\\\\MyEvent\", (data) => {\r\n      console.log(\"pusher\", data);\r\n    if (data.data.resource_id === `tl_${props.userlogin.malop}`) {\r\n      if (data.data.isDelete) {\r\n        if (data.data.active) {\r\n          //   const newData = tailieu.filter((item) => item._id !== data.data._id);\r\n          setTaiLieu((tailieu) => [\r\n            ...tailieu.filter((item) => item._id !== data.data._id),\r\n          ]);\r\n        } else {\r\n          setTaiLieuPending((tailieu) => [\r\n            ...tailieu.filter((item) => item._id !== data.data._id),\r\n          ]);\r\n        }\r\n      }\r\n\r\n      if (data.data.isAdd === true) {\r\n        let item = data.data;\r\n        item._id = item._id[\"$oid\"];\r\n        if (item.active === true) {\r\n          setTaiLieu((tailieu) => [...tailieu, item]);\r\n        } else {\r\n          setTaiLieuPending((tailieu) => [...tailieu, item]);\r\n        }\r\n      }\r\n\r\n      if (data.data.isUpdate === true) {\r\n        if (data.data.active) {\r\n          setTaiLieu((tailieu) =>\r\n            tailieu.map((item) =>\r\n              item._id === data.data._id ? data.data : item\r\n            )\r\n          );\r\n        } else {\r\n          setTaiLieu((tailieu) =>\r\n            tailieu.filter((item) => item._id !== data.data._id)\r\n          );\r\n          setTaiLieuPending((tailieu) => [...tailieu, data.data]);\r\n        }\r\n      }\r\n\r\n      if (data.data.isApprove === true) {\r\n        setTaiLieu((tailieu) => [...tailieu, data.data]);\r\n        setTaiLieuPending((tailieu) =>\r\n          tailieu.filter((item) => item._id !== data.data._id)\r\n        );\r\n      }\r\n    }\r\n    });\r\n  }, []);\r\n\r\n  return isLoading ? (\r\n    <ClipLoader />\r\n  ) : (\r\n    <>\r\n      <Router>\r\n        <nav className=\"navbar navbar-expand-lg navbar-light bg-light\">\r\n          <button\r\n            className=\"navbar-toggler\"\r\n            type=\"button\"\r\n            data-toggle=\"collapse\"\r\n            data-target=\"#navbarSupportedContent\"\r\n            aria-controls=\"navbarSupportedContent\"\r\n            aria-expanded=\"false\"\r\n            aria-label=\"Toggle navigation\"\r\n          >\r\n            <span className=\"navbar-toggler-icon\"></span>\r\n          </button>\r\n\r\n          <div className=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\r\n            <ul className=\"navbar-nav mr-auto\">\r\n              <li className=\"nav-item\">\r\n                <Link\r\n                  className=\"nav-link\"\r\n                  to={{\r\n                    pathname: `/them-tai-lieu`,\r\n                    state: {\r\n                      malop: props.privateInfo.malop,\r\n                      accessRights: props.accessRights,\r\n                      userlogin: props.userlogin,\r\n                    },\r\n                  }}\r\n                >\r\n                  Thêm tài liệu\r\n                </Link>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </nav>\r\n\r\n        <DanhSachTaiLieu\r\n          tailieu={tailieu}\r\n          tailieuPending={tailieuPending}\r\n          accessRights={props.accessRights}\r\n          userlogin={props.userlogin}\r\n          handleDeleteTaiLieu={handleDeleteTaiLieu}\r\n        />\r\n\r\n        <div className=\"col-md-12\">\r\n          <Switch>\r\n            <Route\r\n              exact\r\n              path=\"/them-tai-lieu\"\r\n              component={(props) => (\r\n                <ThemTaiLieu\r\n                  {...props}\r\n                  // handleCreate={handleCreate}\r\n                  privateInfo={props.privateInfo}\r\n                />\r\n              )}\r\n            />\r\n            <Route\r\n              exact\r\n              path=\"/chinh-sua-tai-lieu\"\r\n              component={(props) => (\r\n                <ChinhSuaTaiLieu\r\n                  {...props}\r\n                  //   handleEdit={handleEdit}\r\n                />\r\n              )}\r\n            />\r\n          </Switch>\r\n        </div>\r\n      </Router>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default TaiLieu;\r\n"]},"metadata":{},"sourceType":"module"}