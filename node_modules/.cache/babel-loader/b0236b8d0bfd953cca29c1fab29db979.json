{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projects_User\\\\lucky\\\\full_project\\\\frontend\\\\src\\\\components\\\\page\\\\Admin\\\\PeopleSetting.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { private_key_chatroom, chat_projectid } from \"../security\"; // import context\n// import { userContext } from '../../../Store';\n\nimport MembersOfChat from \"./MembersOfChat\";\nimport AddMemberToChat from \"./AddMemberToChat\";\nimport UploadAvatar from \"./UploadAvatar\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar axios = require(\"axios\");\n\nfunction PeopleSetting(props) {\n  _s();\n\n  const [isEditUser, setIsEditUser] = React.useState(null);\n  const [users_not_attend, setUsersNotAttend] = React.useState([]);\n  const [searchResult, setSearchResult] = React.useState([]);\n  const [imageUser, setImageUser] = React.useState({});\n  const classname = props.chat ? props.chat.title : \"\";\n  const person = props.chat.people;\n\n  const check_edit_users = async () => {\n    const url = `/api/check-edit-users/${props.username}/${classname}`;\n    const result = await axios.get(url);\n    const {\n      status\n    } = result.data;\n    setIsEditUser(status); // console.log(\"đã thực hiện check_edit_user\")\n\n    if (props.username === \"hainguyenvan6799.webdev@gmail.com\") {\n      setIsEditUser(true);\n    }\n  };\n\n  const user_not_attend_room_chat = async () => {\n    try {\n      const url = `/api/get-users-in-specific-class/${classname}`;\n      const response = await axios.get(url);\n\n      if (response.data.status === true) {\n        const {\n          users\n        } = await response.data;\n        setUsersNotAttend(users_not_attend => [...users_not_attend, ...users]);\n      } else {\n        alert(response.data.message);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  React.useEffect(() => {\n    if (props.chat.people.length > 2) {\n      check_edit_users();\n      user_not_attend_room_chat();\n    }\n\n    return () => {\n      setIsEditUser(null);\n      setUsersNotAttend([]);\n      setSearchResult([]);\n    };\n  }, [props.chat.id]);\n\n  const handleDelete = e => {\n    e.preventDefault();\n    const email_of_member = e.target.value;\n    var data = JSON.stringify({\n      username: email_of_member\n    });\n    var config = {\n      method: \"put\",\n      url: `https://api.chatengine.io/chats/${props.chat.id}/people/\\n`,\n      headers: {\n        \"X-Requested-With\": \"XMLHttpRequest\",\n        \"Project-ID\": chat_projectid,\n        // 'User-Name': 'hainguyenvan6799.webdev@gmail.com',\n        // 'User-Secret': 'Hai123456',\n        \"User-Name\": \"hainguyenvan6799.webdev@gmail.com\",\n        \"User-Secret\": \"Hai123456\",\n        \"Content-Type\": \"application/json\"\n      },\n      data: data\n    };\n    axios(config).then(function (response) {\n      console.log(JSON.stringify(response.data));\n      axios.post(\"/api/remove-member-in-chat\", {\n        email: email_of_member\n      }).then(res => {\n        setUsersNotAttend(users_not_attend => [...users_not_attend, email_of_member]);\n      }).catch(err => {\n        console.log(err);\n      }); // setSomethingChange(true);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const handleKeyUp = e => {\n    const userInput = e.target.value;\n    let emptyArray = [];\n\n    if (userInput !== \"\") {\n      emptyArray = users_not_attend.filter(data => {\n        return data.toLocaleLowerCase().indexOf(userInput) !== -1 ? data : \"\";\n      });\n      setSearchResult(emptyArray);\n    } else {\n      setSearchResult([]);\n    }\n  };\n\n  const addMember = e => {\n    e.preventDefault(users_not_attend); // console.log(e.target.value);\n\n    var axios_chat = require(\"axios\");\n\n    var data = JSON.stringify({\n      username: e.target.value\n    });\n    var config = {\n      method: \"post\",\n      url: `https://api.chatengine.io/chats/${props.chat.id}/people/\\n`,\n      headers: {\n        \"Project-ID\": chat_projectid,\n        \"User-Name\": \"hainguyenvan6799.webdev@gmail.com\",\n        \"User-Secret\": \"Hai123456\",\n        \"Content-Type\": \"application/json\"\n      },\n      data: data\n    };\n    axios(config).then(function (response) {\n      const data = {\n        email: e.target.value,\n        room_chat_id: props.chat.id\n      };\n      axios.post(\"/api/update-room-chat-for-user\", data).then(res => {\n        const {\n          message\n        } = res.data; // console.log(message);\n\n        if (message === \"success\") {\n          let index = users_not_attend.indexOf(e.target.value);\n          users_not_attend.splice(index, 1);\n          setUsersNotAttend([...users_not_attend]);\n          setSearchResult([]);\n        } else {\n          console.log(message);\n        }\n      }).catch(err => {\n        console.log(err);\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const check_file_extension = file => {\n    const file_extension = file.name.split(\".\")[1];\n\n    if (file_extension !== undefined) {\n      if (file_extension !== \"png\" && file_extension !== \"jpg\") {\n        return false;\n      } else {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  const changeImage = e => {\n    e.preventDefault();\n    const file = e.target.files[0];\n\n    if (!check_file_extension(file)) {\n      alert(\"Bạn cần chọn file có định dạng .jpg hoặc .png\");\n    } else {\n      setImageUser(e.target.files[0]);\n    }\n  };\n\n  const uploadImage = e => {\n    e.preventDefault();\n\n    if (imageUser.name !== undefined) {\n      var data = new FormData();\n      data.append(\"avatar\", imageUser, imageUser.name);\n      var config = {\n        method: \"patch\",\n        url: `https://api.chatengine.io/users/${props.userIDChat}/`,\n        headers: {\n          \"PRIVATE-KEY\": private_key_chatroom\n        },\n        data: data\n      };\n      axios(config).then(res => {\n        alert(\"Thay đổi ảnh đại diện thành công, vui lòng tải lại trang.\");\n      }).catch(err => console.log(err));\n    } else {\n      alert(\"Bạn không được để trống file\");\n    }\n  }; // declare useContext\n\n\n  return isEditUser !== null ? /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(MembersOfChat, { ...props,\n      persons: person,\n      isUserCanEdit: isEditUser,\n      handleDelete: handleDelete\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AddMemberToChat, { ...props,\n      isUserCanEdit: isEditUser,\n      searchResult: searchResult,\n      handleKeyUp: handleKeyUp,\n      addMember: addMember\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(UploadAvatar, { ...props,\n      uploadImage: uploadImage,\n      changeImage: changeImage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 221,\n    columnNumber: 5\n  }, this) : props.chat.people.length > 2 ? \"...Loading...\" : null;\n}\n\n_s(PeopleSetting, \"4+noeFnpE6Fpvnax9HmGXXfogDM=\");\n\n_c = PeopleSetting;\nexport default PeopleSetting;\n\nvar _c;\n\n$RefreshReg$(_c, \"PeopleSetting\");","map":{"version":3,"sources":["C:/Projects_User/lucky/full_project/frontend/src/components/page/Admin/PeopleSetting.js"],"names":["React","private_key_chatroom","chat_projectid","MembersOfChat","AddMemberToChat","UploadAvatar","axios","require","PeopleSetting","props","isEditUser","setIsEditUser","useState","users_not_attend","setUsersNotAttend","searchResult","setSearchResult","imageUser","setImageUser","classname","chat","title","person","people","check_edit_users","url","username","result","get","status","data","user_not_attend_room_chat","response","users","alert","message","err","console","log","useEffect","length","id","handleDelete","e","preventDefault","email_of_member","target","value","JSON","stringify","config","method","headers","then","post","email","res","catch","error","handleKeyUp","userInput","emptyArray","filter","toLocaleLowerCase","indexOf","addMember","axios_chat","room_chat_id","index","splice","check_file_extension","file","file_extension","name","split","undefined","changeImage","files","uploadImage","FormData","append","userIDChat"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { private_key_chatroom, chat_projectid } from \"../security\";\r\n\r\n// import context\r\n// import { userContext } from '../../../Store';\r\nimport MembersOfChat from \"./MembersOfChat\";\r\nimport AddMemberToChat from \"./AddMemberToChat\";\r\nimport UploadAvatar from \"./UploadAvatar\";\r\n\r\nvar axios = require(\"axios\");\r\n\r\nfunction PeopleSetting(props) {\r\n  const [isEditUser, setIsEditUser] = React.useState(null);\r\n  const [users_not_attend, setUsersNotAttend] = React.useState([]);\r\n  const [searchResult, setSearchResult] = React.useState([]);\r\n  const [imageUser, setImageUser] = React.useState({});\r\n  const classname = props.chat ? props.chat.title : \"\";\r\n  const person = props.chat.people;\r\n\r\n  const check_edit_users = async () => {\r\n    const url = `/api/check-edit-users/${props.username}/${classname}`;\r\n    const result = await axios.get(url);\r\n    const { status } = result.data;\r\n    setIsEditUser(status);\r\n    // console.log(\"đã thực hiện check_edit_user\")\r\n    if (props.username === \"hainguyenvan6799.webdev@gmail.com\") {\r\n      setIsEditUser(true);\r\n    }\r\n  };\r\n\r\n  const user_not_attend_room_chat = async () => {\r\n    try {\r\n      const url = `/api/get-users-in-specific-class/${classname}`;\r\n      const response = await axios.get(url);\r\n\r\n      if (response.data.status === true) {\r\n        const { users } = await response.data;\r\n        setUsersNotAttend((users_not_attend) => [\r\n          ...users_not_attend,\r\n          ...users,\r\n        ]);\r\n      } else {\r\n        alert(response.data.message);\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    if (props.chat.people.length > 2) {\r\n      check_edit_users();\r\n      user_not_attend_room_chat();\r\n    }\r\n\r\n    return () => {\r\n      setIsEditUser(null);\r\n      setUsersNotAttend([]);\r\n      setSearchResult([]);\r\n    };\r\n  }, [props.chat.id]);\r\n\r\n  const handleDelete = (e) => {\r\n    e.preventDefault();\r\n    const email_of_member = e.target.value;\r\n\r\n    var data = JSON.stringify({\r\n      username: email_of_member,\r\n    });\r\n\r\n    var config = {\r\n      method: \"put\",\r\n      url: `https://api.chatengine.io/chats/${props.chat.id}/people/\\n`,\r\n      headers: {\r\n        \"X-Requested-With\": \"XMLHttpRequest\",\r\n        \"Project-ID\": chat_projectid,\r\n        // 'User-Name': 'hainguyenvan6799.webdev@gmail.com',\r\n        // 'User-Secret': 'Hai123456',\r\n        \"User-Name\": \"hainguyenvan6799.webdev@gmail.com\",\r\n        \"User-Secret\": \"Hai123456\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      data: data,\r\n    };\r\n\r\n    axios(config)\r\n      .then(function (response) {\r\n        console.log(JSON.stringify(response.data));\r\n        axios\r\n          .post(\"/api/remove-member-in-chat\", {\r\n            email: email_of_member,\r\n          })\r\n          .then((res) => {\r\n            setUsersNotAttend((users_not_attend) => [\r\n              ...users_not_attend,\r\n              email_of_member,\r\n            ]);\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n        // setSomethingChange(true);\r\n      })\r\n      .catch(function (error) {\r\n        console.log(error);\r\n      });\r\n  };\r\n\r\n  const handleKeyUp = (e) => {\r\n    const userInput = e.target.value;\r\n    let emptyArray = [];\r\n    if (userInput !== \"\") {\r\n      emptyArray = users_not_attend.filter((data) => {\r\n        return data.toLocaleLowerCase().indexOf(userInput) !== -1 ? data : \"\";\r\n      });\r\n\r\n      setSearchResult(emptyArray);\r\n    } else {\r\n      setSearchResult([]);\r\n    }\r\n  };\r\n\r\n  const addMember = (e) => {\r\n    e.preventDefault(users_not_attend);\r\n    // console.log(e.target.value);\r\n\r\n    var axios_chat = require(\"axios\");\r\n    var data = JSON.stringify({\r\n      username: e.target.value,\r\n    });\r\n\r\n    var config = {\r\n      method: \"post\",\r\n      url: `https://api.chatengine.io/chats/${props.chat.id}/people/\\n`,\r\n      headers: {\r\n        \"Project-ID\": chat_projectid,\r\n        \"User-Name\": \"hainguyenvan6799.webdev@gmail.com\",\r\n        \"User-Secret\": \"Hai123456\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      data: data,\r\n    };\r\n\r\n    axios(config)\r\n      .then(function (response) {\r\n        const data = {\r\n          email: e.target.value,\r\n          room_chat_id: props.chat.id,\r\n        };\r\n        axios\r\n          .post(\"/api/update-room-chat-for-user\", data)\r\n          .then((res) => {\r\n            const { message } = res.data;\r\n            // console.log(message);\r\n            if (message === \"success\") {\r\n              let index = users_not_attend.indexOf(e.target.value);\r\n              users_not_attend.splice(index, 1);\r\n              setUsersNotAttend([...users_not_attend]);\r\n              setSearchResult([]);\r\n            } else {\r\n              console.log(message);\r\n            }\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n      })\r\n      .catch(function (error) {\r\n        console.log(error);\r\n      });\r\n  };\r\n\r\n  const check_file_extension = (file) => {\r\n    const file_extension = file.name.split(\".\")[1];\r\n    if (file_extension !== undefined) {\r\n      if (file_extension !== \"png\" && file_extension !== \"jpg\") {\r\n        return false;\r\n      } else {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const changeImage = (e) => {\r\n    e.preventDefault();\r\n    const file = e.target.files[0];\r\n    if (!check_file_extension(file)) {\r\n      alert(\"Bạn cần chọn file có định dạng .jpg hoặc .png\");\r\n    } else {\r\n      setImageUser(e.target.files[0]);\r\n    }\r\n  };\r\n\r\n  const uploadImage = (e) => {\r\n    e.preventDefault();\r\n    if (imageUser.name !== undefined) {\r\n      var data = new FormData();\r\n      data.append(\"avatar\", imageUser, imageUser.name);\r\n\r\n      var config = {\r\n        method: \"patch\",\r\n        url: `https://api.chatengine.io/users/${props.userIDChat}/`,\r\n        headers: {\r\n          \"PRIVATE-KEY\": private_key_chatroom,\r\n        },\r\n        data: data,\r\n      };\r\n      axios(config)\r\n        .then((res) => {\r\n          alert(\"Thay đổi ảnh đại diện thành công, vui lòng tải lại trang.\");\r\n        })\r\n        .catch((err) => console.log(err));\r\n    } else {\r\n      alert(\"Bạn không được để trống file\");\r\n    }\r\n  };\r\n\r\n  // declare useContext\r\n  return isEditUser !== null ? (\r\n    <div>\r\n      <MembersOfChat\r\n        {...props}\r\n        persons={person}\r\n        isUserCanEdit={isEditUser}\r\n        handleDelete={handleDelete}\r\n      />\r\n\r\n      <AddMemberToChat\r\n        {...props}\r\n        isUserCanEdit={isEditUser}\r\n        searchResult={searchResult}\r\n        handleKeyUp={handleKeyUp}\r\n        addMember={addMember}\r\n      />\r\n\r\n      <UploadAvatar\r\n        {...props}\r\n        uploadImage={uploadImage}\r\n        changeImage={changeImage}\r\n      />\r\n    </div>\r\n  ) : props.chat.people.length > 2 ? (\r\n    \"...Loading...\"\r\n  ) : null;\r\n}\r\n\r\nexport default PeopleSetting;\r\n"]},"metadata":{},"sourceType":"module"}