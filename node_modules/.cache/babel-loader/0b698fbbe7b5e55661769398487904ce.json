{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projects_User\\\\lucky\\\\full_project\\\\frontend\\\\src\\\\components\\\\import_users\\\\ImportUsersForm.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport ErrorsAlert from './ErrorsAlert';\nimport { giaimadulieu, private_key_chatroom } from '../page/security';\nimport { Link } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class ImportUsersForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      files: {},\n      errors: []\n    };\n    this.onChangeForm = this.onChangeForm.bind(this);\n    this.onSubmitForm = this.onSubmitForm.bind(this);\n  }\n\n  onChangeForm(event) {\n    this.setState({\n      files: event.target.files\n    });\n  }\n\n  onSubmitForm(event) {\n    event.preventDefault();\n    let file = this.state.files;\n    console.log(file);\n    let file_extension = file[0].name.split(\".\")[1];\n\n    if (file_extension !== \"xlsx\") {\n      this.setState({\n        errors: \"Bạn chỉ được nhập file Excel.\"\n      });\n    } else {\n      let formData = new FormData();\n      formData.append('file', file[0]);\n      console.log(formData);\n      axios.post(\"/api/user_import\", formData).then(response => {\n        // response.data.map(item => console.log(item.errorInfo[2]));\n        // console.log(response.data.errors);\n        const errors = response.data.errors;\n\n        if (errors.length !== 0) {\n          this.setState({\n            errors: errors\n          });\n        }\n\n        console.log(response.data.usersImported);\n        const users = response.data.usersImported;\n\n        if (users.length !== 0) {\n          users.map(item => {\n            const username = item.username;\n            const password = giaimadulieu(item.password);\n            var config = {\n              method: 'post',\n              url: 'https://api.chatengine.io/users/',\n              headers: {\n                'PRIVATE-KEY': private_key_chatroom\n              },\n              data: {\n                username: username,\n                secret: password,\n                first_name: username\n              }\n            };\n            axios(config).then(res => {\n              if (res.status) {\n                axios.post(\"/api/update-user-chat-id-using-email\", {\n                  email: username,\n                  'user_chat_id': res.data.id\n                }).then(res => alert(\"Thêm người dùng thành công\")).catch(error => console.log(error));\n              }\n            }).catch(err => console.log(err));\n          });\n        } // this.setState({\n        //     files: {},\n        //     errors: response.data\n        // })\n\n      }).catch(error => console.log(error));\n    }\n  }\n\n  render() {\n    console.log(this.state.errors);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"nav\", {\n        className: \"navbar navbar-expand-lg navbar-light bg-light\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"navbar-toggler\",\n          type: \"button\",\n          \"data-toggle\": \"collapse\",\n          \"data-target\": \"#navbarSupportedContent\",\n          \"aria-controls\": \"navbarSupportedContent\",\n          \"aria-expanded\": \"false\",\n          \"aria-label\": \"Toggle navigation\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"navbar-toggler-icon\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"collapse navbar-collapse\",\n          id: \"navbarSupportedContent\",\n          children: /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"navbar-nav mr-auto\",\n            children: /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"nav-item\",\n              children: /*#__PURE__*/_jsxDEV(Link, {\n                className: \"nav-link\",\n                to: \"/admin/users\",\n                children: \"Quay l\\u1EA1i danh s\\xE1ch\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 101,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: event => this.onSubmitForm(event),\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          onChange: event => this.onChangeForm(event)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-primary\",\n          children: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(ErrorsAlert, {\n          errors: this.state.errors\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Projects_User/lucky/full_project/frontend/src/components/import_users/ImportUsersForm.js"],"names":["React","Component","axios","ErrorsAlert","giaimadulieu","private_key_chatroom","Link","ImportUsersForm","constructor","props","state","files","errors","onChangeForm","bind","onSubmitForm","event","setState","target","preventDefault","file","console","log","file_extension","name","split","formData","FormData","append","post","then","response","data","length","usersImported","users","map","item","username","password","config","method","url","headers","secret","first_name","res","status","email","id","alert","catch","error","err","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport axios from 'axios';\r\nimport ErrorsAlert from './ErrorsAlert';\r\nimport { giaimadulieu, private_key_chatroom } from '../page/security'\r\nimport { Link } from 'react-router-dom';\r\n\r\nexport default class ImportUsersForm extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            files: {},\r\n            errors: []\r\n        }\r\n        this.onChangeForm = this.onChangeForm.bind(this);\r\n        this.onSubmitForm = this.onSubmitForm.bind(this);\r\n    }\r\n\r\n    onChangeForm(event) {\r\n        this.setState({\r\n            files: event.target.files\r\n        })\r\n    }\r\n\r\n    onSubmitForm(event) {\r\n        event.preventDefault();\r\n        let file = this.state.files;\r\n        console.log(file);\r\n        let file_extension = file[0].name.split(\".\")[1];\r\n        if (file_extension !== \"xlsx\") {\r\n            this.setState({\r\n                errors: \"Bạn chỉ được nhập file Excel.\"\r\n            })\r\n        }\r\n        else {\r\n            let formData = new FormData();\r\n            formData.append('file', file[0]);\r\n            console.log(formData)\r\n            axios.post(\"/api/user_import\", formData).then(response => {\r\n                // response.data.map(item => console.log(item.errorInfo[2]));\r\n                // console.log(response.data.errors);\r\n                const errors = response.data.errors;\r\n                if(errors.length !== 0)\r\n                {\r\n                    this.setState( {\r\n                        errors: errors,\r\n                    })\r\n                }\r\n                console.log(response.data.usersImported);\r\n                const users = response.data.usersImported;\r\n                if (users.length !== 0) {\r\n                    users.map(item => {\r\n                        const username = item.username;\r\n                        const password = giaimadulieu(item.password)\r\n\r\n                        var config = {\r\n                            method: 'post',\r\n                            url: 'https://api.chatengine.io/users/',\r\n                            headers: {\r\n                                'PRIVATE-KEY': private_key_chatroom\r\n                            },\r\n                            data: {\r\n                                username: username,\r\n                                secret: password,\r\n                                first_name: username,\r\n                            },\r\n                        };\r\n                        axios(config).then(res => {\r\n                            if (res.status) {\r\n                                axios.post(\"/api/update-user-chat-id-using-email\", {\r\n                                    email: username,\r\n                                    'user_chat_id': res.data.id,\r\n                                }).then(res => alert(\"Thêm người dùng thành công\")).catch(error => console.log(error))\r\n                            }\r\n                        }).catch(err => console.log(err));\r\n\r\n                    })\r\n                }\r\n                // this.setState({\r\n                //     files: {},\r\n                //     errors: response.data\r\n                // })\r\n            }).catch(error => console.log(error))\r\n        }\r\n    }\r\n\r\n    \r\n\r\n    render() {\r\n        console.log(this.state.errors)\r\n        return (\r\n            <div>\r\n                <nav className=\"navbar navbar-expand-lg navbar-light bg-light\">\r\n                    <button className=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarSupportedContent\" aria-controls=\"navbarSupportedContent\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\r\n                        <span className=\"navbar-toggler-icon\"></span>\r\n                    </button>\r\n\r\n                    <div className=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\r\n                        <ul className=\"navbar-nav mr-auto\">\r\n                            <li className=\"nav-item\">\r\n                                <Link className=\"nav-link\" to='/admin/users'>Quay lại danh sách</Link>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                </nav>\r\n\r\n                <form onSubmit={(event) => this.onSubmitForm(event)}>\r\n                    \r\n                    <input type=\"file\" onChange={(event) => this.onChangeForm(event)} />\r\n                    <button className=\"btn btn-primary\">Submit</button>\r\n                    <ErrorsAlert errors={this.state.errors} />\r\n                </form>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}