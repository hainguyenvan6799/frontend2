{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projects_User\\\\lucky\\\\full_project\\\\frontend\\\\src\\\\components\\\\page\\\\User\\\\Login1.js\",\n    _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport React, { useContext } from 'react';\nimport { Link, Redirect, useHistory } from 'react-router-dom'; // import addictional libraries\n\nimport { useFormik } from 'formik';\nimport * as Yup from 'yup';\nimport { giaimadulieu, mahoadulieu_postform } from '../security'; // import basic component\n\nimport Footer from '../../basic_components/Footer';\nimport Header from '../../basic_components/Header'; // import addictional components:\n\nimport ClipLoader from \"react-spinners/ClipLoader\";\nimport { userContext } from '../../../Store';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const get_magiaovien = (arr, checkGroup, CheckMaLop) => {\n  const user = arr.find(({\n    group,\n    malop\n  }) => group === checkGroup && malop === CheckMaLop);\n\n  if (user) {\n    return user.mauser;\n  } else {\n    return null;\n  }\n};\n\nfunction Login() {\n  _s();\n\n  const [isLoading, setLoading] = React.useState(false);\n  const [user, setUser] = useContext(userContext);\n  const history = useHistory();\n  const initialValues = {\n    email: \"\",\n    password: \"\"\n  };\n  const validationSchema = Yup.object({\n    email: Yup.string().required(\"Email không được để trống\").email(\"Bạn cần nhập đúng định dạng Email\"),\n    password: Yup.string().required(\"Password không được bỏ trống\").matches(/^[a-zA-Z0-9]{6,20}$/g, 'Password có thể là chữ thường hoặc in hoa hoặc số và có độ dài ít nhất 6 ký tự, nhiều nhất là 10 ký tự.')\n  });\n\n  const login = async userInfo => {\n    setLoading(true);\n    const encryptedEmail = mahoadulieu_postform(userInfo.email);\n    const encryptedPassword = mahoadulieu_postform(userInfo.password);\n    const datasTransform = {\n      email: encryptedEmail,\n      password: encryptedPassword\n    };\n    const response = await axios.post('/api/login', datasTransform);\n\n    if (response.data.status) {\n      const {\n        name,\n        email,\n        is_updated_info,\n        mauser,\n        sex,\n        group,\n        malop,\n        active,\n        user_chat_id\n      } = giaimadulieu(response.data.data);\n      const magiaovien = giaimadulieu(response.data.magiaovien);\n      const token = 'Bearer ' + response.data.token;\n      setUser({ ...user,\n        name: name,\n        email: email,\n        is_updated_info,\n        mauser,\n        sex,\n        group,\n        malop,\n        magiaovien: magiaovien,\n        active,\n        user_chat_id\n      });\n      localStorage.setItem('token', token);\n      const encoded_email = mahoadulieu_postform(userInfo.email);\n      const encoded_password = mahoadulieu_postform(userInfo.password);\n      localStorage.setItem('email', encoded_email);\n      localStorage.setItem('password', encoded_password);\n\n      if (!active) {\n        alert(\"Tài khoản chưa được kích hoạt, vui lòng liên hệ người quản trị.\");\n      } else {\n        if (!is_updated_info) {\n          history.push('/trang_cap_nhat_thong_tin');\n        } else {\n          history.push('/');\n        }\n      }\n\n      setLoading(false);\n    } else {\n      alert(response.data.message);\n      window.location.href = \"/signin\";\n    }\n  };\n\n  const onSubmit = async values => {\n    const {\n      email,\n      password\n    } = values; // login({ email: encryptedEmail, password: encryptedPassword });\n\n    login({\n      email: email,\n      password: password\n    });\n  };\n\n  const formik = useFormik({\n    initialValues,\n    validationSchema,\n    onSubmit\n  });\n  const {\n    handleChange,\n    handleSubmit,\n    handleBlur\n  } = formik;\n\n  const back_ground_form = () => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"page\",\n      className: \"container-fluid mt-0\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"page-content\",\n        className: \"row\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"region-main-box\",\n          className: \"col-12\",\n          children: /*#__PURE__*/_jsxDEV(\"section\", {\n            id: \"region-main\",\n            className: \"col-12\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"notifications\",\n              id: \"user-notifications\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              role: \"main\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                id: \"maincontent\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 46\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"my-1 my-sm-5\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 76\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"row justify-content-center\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col-xl-6 col-sm-8 \",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"card\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"card-block\",\n                      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                        className: \"card-header text-center\",\n                        children: \"H\\u1EC7 Th\\u1ED1ng Li\\xEAn L\\u1EA1c Tr\\u1EF1c Tuy\\u1EBFn - IUH\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 130,\n                        columnNumber: 49\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"card-body\",\n                        children: /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"row justify-content-md-center\",\n                          children: /*#__PURE__*/_jsxDEV(\"div\", {\n                            className: \"col-md-8\",\n                            children: form()\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 135,\n                            columnNumber: 57\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 134,\n                          columnNumber: 53\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 131,\n                        columnNumber: 49\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 129,\n                      columnNumber: 45\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 128,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 127,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 126,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }, this);\n  };\n\n  const form = () => {\n    return /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"mt-3\",\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"email\",\n          className: \"col-sm-2 col-form-label\",\n          children: \"Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-sm-10\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"email\",\n            id: \"email\",\n            className: \"form-control\",\n            onChange: handleChange,\n            onBlur: handleBlur\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 25\n          }, this), formik.errors.email ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-danger\",\n            children: formik.errors.email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 49\n          }, this) : null]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"password\",\n          className: \"col-sm-2 col-form-label\",\n          children: \"Password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-sm-10\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            name: \"password\",\n            id: \"password\",\n            className: \"form-control\",\n            onChange: handleChange,\n            onBlur: handleBlur\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 25\n          }, this), formik.errors.password ? /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-danger\",\n            children: formik.errors.password\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 52\n          }, this) : null]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-primary btn-block mt-3\",\n        id: \"loginbtn\",\n        children: \"\\u0110\\u0103ng nh\\u1EADp\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"forgot-password text-center\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/forgot_password\",\n          children: \"Forgot Password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }, this);\n  };\n\n  const full_page = () => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 17\n      }, this), back_ground_form(), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 13\n    }, this);\n  };\n\n  React.useEffect(() => {\n    return () => {\n      \"đã chạy\";\n\n      setLoading(false);\n    };\n  }, []);\n  return (\n    /*#__PURE__*/\n    // isLoading ? <ClipLoader size={100} color={\"green\"} /> : (user.name === \"\" && user.email === \"\") ? full_page() : <Redirect to=\"/trang_cap_nhat_thong_tin\" />\n    _jsxDEV(\"div\", {\n      children: isLoading ? /*#__PURE__*/_jsxDEV(ClipLoader, {\n        size: 100,\n        color: \"green\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 27\n      }, this) : user.name === \"\" && user.email === \"\" ? full_page() : /*#__PURE__*/_jsxDEV(Redirect, {\n        to: \"/trang_cap_nhat_thong_tin\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 127\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 9\n    }, this)\n  );\n}\n\n_s(Login, \"oAw7YRLYXeyB/bfDMf891hhNsqo=\", false, function () {\n  return [useHistory, useFormik];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["C:/Projects_User/lucky/full_project/frontend/src/components/page/User/Login1.js"],"names":["axios","React","useContext","Link","Redirect","useHistory","useFormik","Yup","giaimadulieu","mahoadulieu_postform","Footer","Header","ClipLoader","userContext","get_magiaovien","arr","checkGroup","CheckMaLop","user","find","group","malop","mauser","Login","isLoading","setLoading","useState","setUser","history","initialValues","email","password","validationSchema","object","string","required","matches","login","userInfo","encryptedEmail","encryptedPassword","datasTransform","response","post","data","status","name","is_updated_info","sex","active","user_chat_id","magiaovien","token","localStorage","setItem","encoded_email","encoded_password","alert","push","message","window","location","href","onSubmit","values","formik","handleChange","handleSubmit","handleBlur","back_ground_form","form","errors","full_page","useEffect"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport React, { useContext } from 'react'\r\nimport { Link, Redirect, useHistory } from 'react-router-dom';\r\n\r\n// import addictional libraries\r\nimport { useFormik } from 'formik';\r\nimport * as Yup from 'yup';\r\n\r\nimport { giaimadulieu, mahoadulieu_postform } from '../security';\r\n\r\n// import basic component\r\nimport Footer from '../../basic_components/Footer';\r\nimport Header from '../../basic_components/Header';\r\n\r\n// import addictional components:\r\nimport ClipLoader from \"react-spinners/ClipLoader\";\r\nimport { userContext } from '../../../Store';\r\n\r\nexport const get_magiaovien = (arr, checkGroup, CheckMaLop) => {\r\n    const user = arr.find(( {group, malop} ) => group === checkGroup && malop === CheckMaLop);\r\n    if(user)\r\n    {\r\n        return user.mauser;\r\n    }\r\n    else\r\n    {\r\n        return null;\r\n    }\r\n}\r\n\r\nfunction Login() {\r\n    \r\n    const [isLoading, setLoading] = React.useState(false);\r\n\r\n    const [user, setUser] = useContext(userContext);\r\n\r\n    const history = useHistory();\r\n\r\n    const initialValues = {\r\n        email: \"\",\r\n        password: \"\"\r\n    }\r\n\r\n    const validationSchema = Yup.object({\r\n        email: Yup.string().required(\"Email không được để trống\").email(\"Bạn cần nhập đúng định dạng Email\"),\r\n        password: Yup.string()\r\n            .required(\"Password không được bỏ trống\")\r\n            .matches(/^[a-zA-Z0-9]{6,20}$/g, 'Password có thể là chữ thường hoặc in hoa hoặc số và có độ dài ít nhất 6 ký tự, nhiều nhất là 10 ký tự.'),\r\n    });\r\n\r\n    const login = async (userInfo) => {\r\n        setLoading(true);\r\n        const encryptedEmail = mahoadulieu_postform(userInfo.email);\r\n        const encryptedPassword = mahoadulieu_postform(userInfo.password);\r\n        const datasTransform = { email: encryptedEmail, password: encryptedPassword };\r\n        const response = await axios.post('/api/login', datasTransform);\r\n        if (response.data.status) {\r\n\r\n            const { name, email, is_updated_info, mauser, sex, group, malop, active, user_chat_id } = giaimadulieu(response.data.data);\r\n            const magiaovien = giaimadulieu(response.data.magiaovien)\r\n            const token = 'Bearer ' + response.data.token;\r\n            setUser(\r\n                {\r\n                    ...user,\r\n                    name: name,\r\n                    email: email,\r\n                    is_updated_info,\r\n                    mauser,\r\n                    sex,\r\n                    group,\r\n                    malop,\r\n                    magiaovien: magiaovien,\r\n                    active,\r\n                    user_chat_id\r\n                });\r\n\r\n            localStorage.setItem('token', token);\r\n\r\n            const encoded_email = mahoadulieu_postform(userInfo.email);\r\n            const encoded_password = mahoadulieu_postform(userInfo.password);\r\n\r\n            localStorage.setItem('email', encoded_email);\r\n            localStorage.setItem('password', encoded_password);\r\n\r\n            if (!active) {\r\n                alert(\"Tài khoản chưa được kích hoạt, vui lòng liên hệ người quản trị.\");\r\n            }\r\n            else {\r\n                if (!is_updated_info) {\r\n                    history.push('/trang_cap_nhat_thong_tin');\r\n                }\r\n                else {\r\n                    history.push('/');\r\n                }\r\n            }\r\n            setLoading(false)\r\n        }\r\n        else {\r\n            alert(response.data.message);\r\n            window.location.href = \"/signin\";\r\n    }\r\n    }\r\n\r\n    const onSubmit = async (values) => {\r\n        const { email, password } = values;\r\n        // login({ email: encryptedEmail, password: encryptedPassword });\r\n        login({email: email, password: password});\r\n    }\r\n\r\n    const formik = useFormik({\r\n        initialValues,\r\n        validationSchema,\r\n        onSubmit,\r\n    })\r\n\r\n    const { handleChange, handleSubmit, handleBlur } = formik;\r\n\r\n    const back_ground_form = () => {\r\n        return (\r\n            <div id=\"page\" className=\"container-fluid mt-0\">\r\n                <div id=\"page-content\" className=\"row\">\r\n                    <div id=\"region-main-box\" className=\"col-12\">\r\n                        <section id=\"region-main\" className=\"col-12\">\r\n                            <span className=\"notifications\" id=\"user-notifications\"></span>\r\n                            <div role=\"main\"><span id=\"maincontent\"></span><div className=\"my-1 my-sm-5\"></div>\r\n                                <div className=\"row justify-content-center\">\r\n                                    <div className=\"col-xl-6 col-sm-8 \">\r\n                                        <div className=\"card\">\r\n                                            <div className=\"card-block\">\r\n                                                <h2 className=\"card-header text-center\">Hệ Thống Liên Lạc Trực Tuyến - IUH</h2>\r\n                                                <div className=\"card-body\">\r\n\r\n\r\n                                                    <div className=\"row justify-content-md-center\">\r\n                                                        <div className=\"col-md-8\">\r\n                                                            {form()}\r\n                                                        </div>\r\n\r\n\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div></div>\r\n\r\n                        </section>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const form = () => {\r\n        return (\r\n            <form className=\"mt-3\" onSubmit={handleSubmit}>\r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"email\" className=\"col-sm-2 col-form-label\">Email</label>\r\n                    <div className=\"col-sm-10\">\r\n                        <input\r\n                            type=\"text\"\r\n                            name=\"email\"\r\n                            id=\"email\"\r\n                            className=\"form-control\"\r\n                            onChange={handleChange}\r\n                            onBlur={handleBlur}\r\n                        />\r\n                        {formik.errors.email ? (<p className=\"text-danger\">{formik.errors.email}</p>) : null}\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"form-group row\">\r\n                    <label htmlFor=\"password\" className=\"col-sm-2 col-form-label\">Password</label>\r\n                    <div className=\"col-sm-10\">\r\n                        <input\r\n                            type=\"password\"\r\n                            name=\"password\"\r\n                            id=\"password\"\r\n                            className=\"form-control\"\r\n                            onChange={handleChange}\r\n                            onBlur={handleBlur}\r\n                        />\r\n                        {formik.errors.password ? (<p className=\"text-danger\">{formik.errors.password}</p>) : null}\r\n                    </div>\r\n                </div>\r\n\r\n                <button type=\"submit\" className=\"btn btn-primary btn-block mt-3\" id=\"loginbtn\">Đăng nhập</button>\r\n                <p className=\"forgot-password text-center\">\r\n                    <Link to=\"/forgot_password\">Forgot Password</Link>\r\n                </p>\r\n            </form>\r\n        )\r\n    }\r\n\r\n    const full_page = () => {\r\n        return (\r\n            <div>\r\n                <Header />\r\n                {back_ground_form()}\r\n                <Footer />\r\n            </div>\r\n        )\r\n\r\n    }\r\n\r\n    React.useEffect(() => {\r\n\r\n        return () => {\r\n            \"đã chạy\"\r\n            setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    return (\r\n        // isLoading ? <ClipLoader size={100} color={\"green\"} /> : (user.name === \"\" && user.email === \"\") ? full_page() : <Redirect to=\"/trang_cap_nhat_thong_tin\" />\r\n        <div>\r\n            { isLoading ? <ClipLoader size={100} color={\"green\"} /> : (user.name === \"\" && user.email === \"\") ? full_page() : <Redirect to=\"/trang_cap_nhat_thong_tin\" />}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Login\r\n"]},"metadata":{},"sourceType":"module"}